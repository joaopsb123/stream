<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Conectando...</title>
  <script>
    async function init() {
      const code = new URLSearchParams(window.location.search).get("code");
      if (!code) return alert("Sem c√≥digo");

      try {
        const res = await fetch(`/api/callback?code=${code}`);
        const data = await res.json();

        if (data.user) {
          localStorage.setItem("user", JSON.stringify(data.user));
          window.location.href = "/";
        } else {
          alert("Erro ao autenticar");
        }
      } catch {
        alert("Erro no servidor");
      }
    }
    init();
  </script>
</head>
<body style="background:#000;color:#fff;text-align:center;padding:30px;">
  <p>Carregando...</p>
</body>
</html>
